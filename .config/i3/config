#\/ This file has been auto-generated by i3-config-wizard(1).
# It will not be overwritten, so edit it as you like.
#
# Should you change your keyboard layout some time, delete
# this file and re-run i3-config-wizard(1).
#

# All "bind..." commands should be immediately preceded by a comment on a new line
# which should briefly explain the purpose of the command

# i3 config file (v4)
#
# Please see https://i3wm.org/docs/userguide.html for a complete reference!

# Set i3 modifier to Win key
set $mod Mod4

# Get colours from ~/.Xresources file
set $white #ffffff
set $black #000000

exec_always --no-startup-id xrdb ~/.Xresources
set_from_resource $bg background $black
set_from_resource $tl textlight $white
set_from_resource $td textdark $black
set_from_resource $accent1 accent1 #444444
set_from_resource $accent2 accent2 #444444

# Start background processes
# Start polkit auth agent (e.g. for password prompt on save non-owned file)
exec --no-startup-id lxpolkit &
# Start bluetooth tray manager
exec --no-startup-id blueman-applet
# Start network manager tray applet
exec --no-startup-id nm-applet
# Gnome lockscreen
exec_always --no-startup-id /usr/bin/gnome-screensaver
# compton
#exec_always compton --config ~/.config/compton/compton.conf -b
#exec_always compton --backend glx --paint-on-overlay --vsync opengl-swc #
#exec_always compton --config ~/.config/compton/compton.conf -b
# OR
# picom
# b in background, CG to disable shadows
# TODO can you have both cli flags and config?
exec_always picom #-b -CG

# Set background 
exec_always --no-startup-id xsetroot -solid "$bg"


# Perform setup tasks
# Set keyboard layout UK ref: https://superuser.com/questions/1147320/how-to-change-keyboard-layout-in-i3 
exec_always --no-startup-id setxkbmap -layout gb
# Get copy paste working in VMware...
exec --no-startup-id vmware-user-suid-wrapper
# Fix scaling using Xresources file (value inserted in setup script)
# exec_always bash ~/.devenv/sethdpi.sh # don't run here, run *before* restart

# General (non-i3 specific) keybinds
# Pulse Audio controls
# TODO fix to support multiple devices, to limit to 100%, and to display percentage on i3bar
set $audio_device 2
# Increase sound volume
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume $audio_device +5%
# Decrease sound volume 
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume $audio_device -5%
# Mute sound
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute $audio_device toggle

# Screen brightness controls
# Increase brightness
bindsym XF86MonBrightnessUp exec ~/.devenv/increase_brightness.sh
# Decrease brightness
bindsym XF86MonBrightnessDown exec ~/.devenv/decrease_brightness.sh


# Media player controls
# Media: play
bindsym XF86AudioPlay exec playerctl play
# Media: Pause
bindsym XF86AudioPause exec playerctl pause
# Media: next / skip track
bindsym XF86AudioNext exec playerctl next
# Media: previous / last track
bindsym XF86AudioPrev exec playerctl previous




# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:monospace 8 #default

# This font is widely installed, provides lots of unicode glyphs, right-to-left
# text rendering and scalability on retina/hidpi displays (thanks to pango).
# font pango:DejaVu Sans Mono 8

# Start alttab - support for alt tab
exec_always --no-startup-id alttab -fg "$accent1" -bg "$bg" -frame "$accent2" -t 128x150 -i 127x64
# Tab between workspaces
bindsym $mod+Tab workspace next_on_output
bindsym $mod+Shift+Tab workspace prev_on_output
# Switch between workspaces
bindsym $mod+S workspace back_and_forth

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# start a terminal. Also toggle split, allowing spiral splitting for terminals only. 
# Open: terminal
bindsym $mod+Return exec gnome-terminal #urxvt

# other program bindings
# Open: Google Chrome
bindsym $mod+b exec google-chrome
# Open: VSCode
bindsym $mod+c exec code
# Open: files
bindsym $mod+n exec nautilus
# View cheatsheet
bindsym $mod+i exec code ~/.binds.txt # View this cheatsheet
# Refresh cheatsheet from i3 config
bindsym $mod+Shift+i exec ~/.devenv/cheatsheet_update.sh



# Kill focused window
bindsym $mod+q kill

# start dmenu (a program launcher)
#bindsym $mod+d exec dmenu_run
# There also is the (new) i3-dmenu-desktop which only displays applications
# shipping a .desktop file. It is a wrapper around dmenu, so you need that
# installed.
# Dmenu (application launcher)
bindsym $mod+d exec --no-startup-id i3-dmenu-desktop --dmenu="dmenu -i -fn 'Noto Sans:size=8'"


# change focus
# Focus: left
# bindsym $mod+j focus left
# # Focus: down
# bindsym $mod+k focus down
# # Focus: up
# bindsym $mod+l focus up
# # Focus: right
# bindsym $mod+semicolon focus right

# alternatively, you can use the cursor keys:
# Focus: left
bindsym $mod+Left focus left
# Focus: down
bindsym $mod+Down focus down
# Focus: up
bindsym $mod+Up focus up
# Focus: right
bindsym $mod+Right focus right

# Focus: parent
bindsym $mod+a focus parent

# Focus: child
bindsym $mod+z focus child

# move focused window
# # Move Focused: left
# bindsym $mod+Shift+j move left
# # Move Focused: down
# bindsym $mod+Shift+k move down
# # Move Focused: up
# bindsym $mod+Shift+l move up
# # Move Focused: right
# bindsym $mod+Shift+semicolon move right

# alternatively, you can use the cursor keys:
# Move Focused: left
bindsym $mod+Shift+Left move left
# Move Focused: down
bindsym $mod+Shift+Down move down
# Move Focused: up
bindsym $mod+Shift+Up move up
# Move Focused: right
bindsym $mod+Shift+Right move right

# Split: horizontal
bindsym $mod+h split h

# Split: vertical
bindsym $mod+v split v

# Split: toggle direction
bindsym $mod+t split toggle


# Focused: fullscreen
bindsym $mod+f fullscreen toggle

# Focused: change layout
# Focused: change layout stacking
# bindsym $mod+s layout stacking # who really wants this?
# Focused: change layout tabbed
bindsym $mod+w layout tabbed
# Focused: change layout split
bindsym $mod+e layout toggle split


# Focused: toggle floating
bindsym $mod+Shift+space floating toggle

# Toggle view floating / tiled
bindsym $mod+space focus mode_toggle

# workspace names
set $workspace1 "1"
set $workspace2 "2"
set $workspace3 "3"
set $workspace4 "4"
set $workspace5 "5"
set $workspace6 "6"
set $workspace7 "7"
set $workspace8 "8"
set $workspace9 "9"
set $workspace10 "10"

# switch to workspace
# Workspace: #1
bindsym $mod+1 workspace $workspace1
# Workspace: #2
bindsym $mod+2 workspace $workspace2
# Workspace: #3
bindsym $mod+3 workspace $workspace3
# Workspace: #4
bindsym $mod+4 workspace $workspace4
# Workspace: #5
bindsym $mod+5 workspace $workspace5
# Workspace: #6
bindsym $mod+6 workspace $workspace6
# Workspace: #7
bindsym $mod+7 workspace $workspace7
# Workspace: #8
bindsym $mod+8 workspace $workspace8
# Workspace: #9
bindsym $mod+9 workspace $workspace9
# Workspace: #10
bindsym $mod+0 workspace $workspace10

# move focused container to workspace
# Move to workspace: #1
bindsym $mod+Shift+1 move container to workspace $workspace1
# Move to workspace: #2
bindsym $mod+Shift+2 move container to workspace $workspace2
# Move to workspace: #3
bindsym $mod+Shift+3 move container to workspace $workspace3
# Move to workspace: #4
bindsym $mod+Shift+4 move container to workspace $workspace4
# Move to workspace: #5
bindsym $mod+Shift+5 move container to workspace $workspace5
# Move to workspace: #6
bindsym $mod+Shift+6 move container to workspace $workspace6
# Move to workspace: #7
bindsym $mod+Shift+7 move container to workspace $workspace7
# Move to workspace: #8
bindsym $mod+Shift+8 move container to workspace $workspace8
# Move to workspace: #9
bindsym $mod+Shift+9 move container to workspace $workspace9
# Move to workspace: #10
bindsym $mod+Shift+0 move container to workspace $workspace10

# move focused workspace to output/monitor
bindsym $mod+Control+right move workspace to output right
bindsym $mod+Control+left move workspace to output left
bindsym $mod+Control+up move workspace to output up
bindsym $mod+Control+down move workspace to output down

# default workspaces per application
#assign [class="Code"] $workspace2
#assign [class="URxvt"] $workspace1
#assign [class="Google-chrome"] $workspace3


# Reload the configuration file
bindsym $mod+Shift+c reload
# Restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
# Restart i3 inplace
bindsym $mod+Shift+r restart


# Set DPI mode (mode/prompt)
bindsym $mod+Shift+d mode "(A)uto, (H)igh, (L)ow dpi"
mode "(A)uto, (H)igh, (L)ow dpi" {

        # set mode
        bindsym a exec "echo 'auto' > ~/.devenv/dpimode ; ~/.devenv/sethdpi.sh"
        bindsym h exec "echo 'hi' > ~/.devenv/dpimode ; ~/.devenv/sethdpi.sh"
        bindsym l exec "echo 'lo' > ~/.devenv/dpimode ; ~/.devenv/sethdpi.sh"

        # back to normal: Enter or Escape
        bindsym Return mode "default" restart #confirm
        bindsym Escape mode "default" #decline changes
}

# Create Log out, Reboot, Poweroff bindings
# Perform power action (mode/prompt)
bindsym $mod+Shift+e mode "(S)leep, (L)ock, (E)xit/logout, (R)eboot, (P)oweroff"
mode "(S)leep, (L)ock, (E)xit/logout, (R)eboot, (P)oweroff" {
        bindsym r exec --no-startup-id systemctl reboot
        bindsym s exec --no-startup-id systemctl suspend; exec --no-startup-id gnome-screensaver-command -l; mode "default"
        bindsym e exit
        bindsym l exec --no-startup-id gnome-screensaver-command -l ; mode "default"
        bindsym p exec --no-startup-id systemctl poweroff

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}


# resize window (you can also use the mouse for that)
# Enter resize mode
bindsym $mod+r mode "resize"
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        # bindsym j resize shrink width 10 px or 10 ppt
        # bindsym k resize grow height 10 px or 10 ppt
        # bindsym l resize shrink height 10 px or 10 ppt
        # bindsym semicolon resize grow width 10 px or 10 ppt

        # same bindings, but for the arrow keys
        bindsym Left resize shrink width 10 px or 10 ppt
        bindsym Down resize grow height 10 px or 10 ppt
        bindsym Up resize shrink height 10 px or 10 ppt
        bindsym Right resize grow width 10 px or 10 ppt

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}


##### Custom functions #####
# Screen snipping (with flameshot)
exec --no-startup-id flameshot
# Start: prinscreen utility (flameshot)
bindsym Print exec "flameshot gui"


# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
# also configure colours
bar {
        colors {
        background $bg
        statusline $white 
        separator $accent1

        # colour of border, background, and text
        focused_workspace       $bg $accent2 $white
        active_workspace        $bg $bg $white
        inactive_workspace      $bg $bg $white
        urgent_workspace       $bg $accent1 $bg
    }
        status_command i3status
}
 
#                               BORDER           BACKGROUND  TEXT    INDICATOR   CHILD_BORDER
client.focused	                $accent1         $accent1    $td     $accent2    $accent1
client.focused_inactive	        $bg              $bg         $tl     $bg         $bg
client.unfocused		$bg              $bg         $tl     $bg         $bg
client.urgent			$accent2         $accent2    $tl     $bg         $bg
client.placeholder		$bg              $bg         $tl     $bg         $bg
client.background		$bg     

# restart on login (once, not always) to force a colour update
exec i3-msg restart

# Open programs on i3 startup

#exec code

